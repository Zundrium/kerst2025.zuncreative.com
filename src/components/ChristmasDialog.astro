---

---

<div id="christmas-dialog" class="hidden">
    <div class="scene">
        <div class="card">
            <div class="card-face front">
                <img
                    src="/img/christmas-card-front.webp"
                    alt="Christmas Card Front"
                />
            </div>
            <div class="card-face back">
                <button id="close-dialog" aria-label="Close">
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        ><line x1="18" y1="6" x2="6" y2="18"></line><line
                            x1="6"
                            y1="6"
                            x2="18"
                            y2="18"></line></svg
                    >
                </button>
                <img
                    src="/img/christmas-card-back.webp"
                    alt="Christmas Card Back"
                />
            </div>
        </div>
    </div>
</div>

<style>
    @import url("https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap");

    #christmas-dialog {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        transition: opacity 0.3s ease;
        perspective: 1000px;
    }

    #christmas-dialog.hidden {
        opacity: 0;
        pointer-events: none;
    }

    .scene {
        width: 800px;
        aspect-ratio: 1.556;
        height: auto;
        max-width: 90%;
        max-height: 90vh;
        perspective: 1000px;
    }

    .scene.slide-in {
        animation: slideIn 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
    }

    .card {
        width: 100%;
        height: 100%;
        position: relative;
        transform-style: preserve-3d;
        transition: transform 1s;
    }

    .card.is-flipped {
        transform: rotateY(180deg);
    }

    .card-face {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        /* overflow: hidden; Removed to allow close button to overhang */
    }

    .front {
        background-color: #fff;
        display: flex; /* Ensure image centers/stretches nicely */
    }

    .front img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 10px; /* Re-apply radius since overflow is visible */
    }

    .back {
        background-color: #fff;
        transform: rotateY(180deg);
        display: flex;
        position: relative;
    }

    .back img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 10px; /* Re-apply radius since overflow is visible */
    }

    @keyframes slideIn {
        0% {
            transform: translateY(120vh) rotateX(20deg);
        }
        100% {
            transform: translateY(0) rotateX(0);
        }
    }

    #close-dialog {
        position: absolute;
        top: 0;
        right: 0;
        background: none;
        border: none;
        cursor: pointer;
        color: #8b0000;
        padding: 0.5rem;
        transition: transform 0.2s;
        z-index: 10;
        background-color: rgba(
            255,
            255,
            255,
            0.5
        ); /* Semi-transparent bg for visibility on image */
        border-radius: 50%;
        transform: translate(50%, -50%);
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    #close-dialog:hover {
        transform: translate(50%, -50%) scale(1.1);
        background-color: rgba(255, 255, 255, 0.9);
    }
</style>

<script>
    const dialog = document.getElementById("christmas-dialog");
    const closeBtn = document.getElementById("close-dialog");
    const scene = document.querySelector("#christmas-dialog .scene");
    const card = document.querySelector("#christmas-dialog .card");

    function openDialog() {
        if (dialog && scene && card) {
            dialog.classList.remove("hidden");
            // Reset state
            card.classList.remove("is-flipped");
            scene.classList.add("slide-in");

            // Schedule flip after slide-in
            setTimeout(() => {
                card.classList.add("is-flipped");
            }, 2000); // 1.5s slide + 0.5s pause
        }
    }

    function closeDialog() {
        if (dialog) {
            dialog.classList.add("hidden");
        }
    }

    // Interactive flip if user clicks the card?
    // Usually a nice touch, but let's stick to closing via button/outside for now to keep it simple,
    // or allow clicking the front to flip manually if they missed it?
    // The prompt says "Then let it flip...", implying auto-sequence.
    // I'll add click-to-flip functionality just in case.
    if (card) {
        card.addEventListener("click", (e) => {
            // Don't flip if clicking close button
            if ((e.target as HTMLElement).closest("#close-dialog")) return;
            card.classList.toggle("is-flipped");
        });
    }

    // Listen for custom event to open
    window.addEventListener("show-christmas-card", openDialog);

    if (closeBtn) {
        closeBtn.addEventListener("click", (e) => {
            e.stopPropagation(); // Prevent card flip
            closeDialog();
        });
    }

    // Close on overlay click
    if (dialog) {
        dialog.addEventListener("click", (e) => {
            if (e.target === dialog) {
                closeDialog();
            }
        });
    }

    // Auto-show on load for testing if not triggered elsewhere
    // window.addEventListener('load', () => setTimeout(openDialog, 1000));
</script>
